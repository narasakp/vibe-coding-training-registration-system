<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สมัครอบรม - Vibe Coding, Spec-Driven Development, Context Engineering</title>
    <link rel="stylesheet" href="styles.css?v=2024081216534">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <style>
        /* Force override progress bar size */
        .progress-container {
            padding: 0.2rem 1rem !important;
            margin-bottom: 0.5rem !important;
            height: auto !important;
            min-height: 30px !important;
            max-height: 40px !important;
        }
        .progress-info {
            font-size: 0.8rem !important;
            margin-bottom: 0.3rem !important;
        }
        .progress-bar-track {
            height: 4px !important;
        }
        
        /* Fix form layout - ensure consistent sizing - FORCE OVERRIDE */
        .form-section .form-row {
            display: flex !important;
            flex-wrap: wrap !important;
            gap: 1rem !important;
            margin-bottom: 1rem !important;
            align-items: flex-start !important;
        }
        
        .form-section .form-row .form-group {
            flex: 1 1 calc(50% - 0.5rem) !important;
            min-width: 250px !important;
            max-width: none !important;
            width: auto !important;
        }
        
        /* Special handling for 4-column layout (Personal Info) */
        .form-section .form-row .form-group:nth-child(n+3) {
            flex: 1 1 calc(25% - 0.75rem) !important;
            min-width: 200px !important;
        }
        
        /* Ensure all form inputs have consistent width within their container */
        .form-section .form-group input,
        .form-section .form-group select,
        .form-section .form-group textarea {
            width: 100% !important;
            box-sizing: border-box !important;
            max-width: none !important;
        }
        
        /* Force specific styling for contact section */
        .form-section h3:contains("ข้อมูลการติดต่อ") + .form-row .form-group,
        .form-section h3 + .form-row .form-group {
            flex: 1 1 calc(50% - 0.5rem) !important;
            min-width: 250px !important;
        }
        
        /* Responsive design for mobile */
        @media (max-width: 768px) {
            .form-section .form-row {
                flex-direction: column !important;
                gap: 0.5rem !important;
            }
            
            .form-section .form-row .form-group {
                flex: 1 1 100% !important;
                min-width: auto !important;
                width: 100% !important;
            }
        }
        
        /* ULTRA SPECIFIC CSS - Target contact section directly */
        .form-section:has(h3:contains("ข้อมูลการติดต่อ")) .form-row,
        .form-section:nth-of-type(2) .form-row {
            display: flex !important;
            gap: 1rem !important;
        }
        
        .form-section:has(h3:contains("ข้อมูลการติดต่อ")) .form-row .form-group,
        .form-section:nth-of-type(2) .form-row .form-group {
            flex: 1 1 calc(50% - 0.5rem) !important;
            min-width: 250px !important;
            width: auto !important;
        }
        
        /* Alternative approach - use attribute selectors */
        div[class*="form-section"] div[class*="form-row"] div[class*="form-group"] {
            flex: 1 1 calc(50% - 0.5rem) !important;
            min-width: 250px !important;
        }
        
        /* Last resort - inline style override */
        .registration-form .form-section .form-row {
            display: flex !important;
            flex-wrap: wrap !important;
            gap: 1rem !important;
        }
        
        .registration-form .form-section .form-row .form-group {
            flex: 1 1 calc(33.333% - 0.67rem) !important;
            min-width: 250px !important;
            max-width: calc(33.333% - 0.67rem) !important;
        }
        
        /* FORCE 3-COLUMN LAYOUT FOR ALL SECTIONS */
        .form-section .form-row {
            display: flex !important;
            flex-wrap: wrap !important;
            gap: 1rem !important;
            width: 100% !important;
        }
        
        .form-section .form-row .form-group {
            flex: 1 !important;
            flex-basis: calc(33.333% - 0.67rem) !important;
            flex-grow: 1 !important;
            flex-shrink: 1 !important;
            min-width: 250px !important;
            max-width: none !important;
        }
        
        /* Override any existing styles */
        .form-section .form-row .form-group input,
        .form-section .form-row .form-group select {
            width: 100% !important;
            box-sizing: border-box !important;
        }
    </style>
</head>
<body>
    <!-- Tech Background -->
    <div id="techBackground" class="tech-background"></div>
    
    <!-- Progress Bar - Fixed at Top -->
    <div class="progress-container">
        <div class="progress-info">
            <span class="progress-text">ความคืบหน้า: <span id="progressPercent">0%</span></span>
            <span class="progress-details">(<span id="progressCount">0</span>/<span id="progressTotal">0</span> ช่อง)</span>
        </div>
        <div class="progress-bar-track">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>

    <div class="container">
        <!-- Header Banner -->
        <div class="banner">
            <div class="banner-content">
                <div class="university-logo">
                    <img src="images/logo.png" alt="มหาวิทยาลัยเทคโนโลยีพระจอมเกล้าธนบุรี" class="logo-img">
                </div>
                
                <h1 class="main-title">
                    โครงการอบรม การใช้ AI เขียนโค้ด
                </h1>
                
                <div class="event-subtitle">
                    ขอเชิญผู้สนใจทั่วไป ร่วมอบรม(ออนไลน์)เชิงปฏิบัติการ
                </div>
                
                <!-- Topic Cards -->
                <div class="topics">
                    <div class="topic-card" data-topic="vibe">
                        <i class="fas fa-code"></i>
                        <h3>Vibe Coding</h3>
                        <p>เขียนโค้ดที่มี Flow และ Rhythm</p>
                    </div>
                    <div class="topic-card" data-topic="spec">
                        <i class="fas fa-file-alt"></i>
                        <h3>Spec-Driven Development</h3>
                        <p>พัฒนาซอฟต์แวร์จาก Specification</p>
                    </div>
                    <div class="topic-card" data-topic="context">
                        <i class="fas fa-brain"></i>
                        <h3>Context Engineering</h3>
                        <p>จัดการ Context ให้มีประสิทธิภาพ</p>
                    </div>
                </div>
                
                <!-- Presenter Info -->
                <div class="presenter-info">
                    <h2>วิทยากรโดย คุณธวัชชัย สิงงาม</h2>
                    <p>Senior DevOps Engineer at PTTEP</p>
                    <div class="presenter-photo">
                        <img src="images/presenter.jpeg" alt="คุณธวัชชัย สิงงาม" class="presenter-img">
                    </div>
                </div>
                
                <!-- Event Details -->
                <div class="event-details">
                    <p><strong>อบรมออนไลน์ ในวันเสาร์ ที่ 16 สิงหาคม 2568</strong></p>
                    <p><strong>เวลา 09.00 น. - 16.00 น.</strong></p>
                </div>
            </div>
        </div>

        <!-- Registration Form -->
        <div class="main-content">
            <div class="form-container">
                <div class="form-header">
                    <h2>ลงทะเบียนเข้าร่วมอบรม</h2>
                    <div class="form-note">
                        <p>ฟรี ค่าลงทะเบียน แต่จำกัดจำนวนผู้เข้าร่วม 500 คน</p>
                        <p>ปิดรับสมัครเมื่อครบจำนวน หรือถึงกำหนดเวลา</p>
                    </div>

                    <!-- Registration Counter -->
                    <div class="registration-counter">
                        <div class="counter-item">
                            <div class="counter-number" id="totalSeats">500</div>
                            <div class="counter-label">จำกัดรับ (คน)</div>
                        </div>
                        <div class="counter-item">
                            <div class="counter-number" id="registeredCount">-</div>
                            <div class="counter-label">ลงทะเบียนแล้ว (คน)</div>
                        </div>
                        <div class="counter-item">
                            <div class="counter-number" id="remainingSeats">-</div>
                            <div class="counter-label">เหลือเพียง (ที่นั่ง)</div>
                        </div>
                    </div>
                    
                    <p class="form-subtitle">กรุณากรอกข้อมูลให้ครบถ้วน</p>
                </div>

                <form id="registrationForm" class="registration-form">
                    <!-- Personal Information -->
                    <div class="form-section">
                        <h3><i class="fas fa-user"></i> ข้อมูลส่วนตัว</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="prefix">คำนำหน้าชื่อ *</label>
                                <input type="text" id="prefix" name="prefix" placeholder="นาย, นาง, นางสาว, ดร., ผศ.ดร, ร.ต.ท." required>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="firstName">ชื่อ *</label>
                                <input type="text" id="firstName" name="firstName" required>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="lastName">นามสกุล *</label>
                                <input type="text" id="lastName" name="lastName" required>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="email">อีเมล *</label>
                                <input type="email" id="email" name="email" required>
                                <div style="margin-top: 2px; color: #666;">ลิงก์อบรม จะส่งไปที่อีเมลนี้</div>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label>เพศ *</label>
                                <div class="radio-group">
                                    <label class="radio-option">
                                        <input type="radio" name="gender" value="male" required>
                                        ชาย
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="gender" value="female" required>
                                        หญิง
                                    </label>
                                </div>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="age">อายุ *</label>
                                <select id="age" name="age" required>
                                    <option value="">เลือกช่วงอายุ</option>
                                    <option value="14">14 ปี หรือน้อยกว่า</option>
                                    <option value="15-17">15-17 ปี</option>
                                    <option value="18-22">18-22 ปี</option>
                                    <option value="23-30">23-30 ปี</option>
                                    <option value="31-50">31-50 ปี</option>
                                    <option value="51-60">51-60 ปี</option>
                                    <option value="61+">61 ปีขึ้นไป</option>
                                </select>
                                <div class="error-message"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Information -->
                    <div class="form-section">
                        <h3><i class="fas fa-building"></i> ข้อมูลการติดต่อ</h3>
                        <div class="form-row" style="display: flex !important; gap: 1rem !important; margin-bottom: 1rem !important;">
                            <div class="form-group" style="flex: 1 1 calc(33.333% - 0.67rem) !important; min-width: 250px !important;">
                                <label for="phone">เบอร์มือถือ *</label>
                                <input type="tel" id="phone" name="phone" placeholder="XXXXXXXXXX" required style="width: 100% !important; box-sizing: border-box !important;">
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group" style="flex: 1 1 calc(33.333% - 0.67rem) !important; min-width: 250px !important;">
                                <label for="organization">หน่วยงาน / สถาบัน *</label>
                                <input type="text" id="organization" name="organization" required style="width: 100% !important; box-sizing: border-box !important;">
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group" style="flex: 1 1 calc(33.333% - 0.67rem) !important; min-width: 250px !important;">
                                <label for="position">ตำแหน่ง / สถานะ *</label>
                                <input type="text" id="position" name="position" required style="width: 100% !important; box-sizing: border-box !important;">
                                <div class="error-message"></div>
                            </div>
                        </div>
                        <div class="form-row" style="display: flex !important; gap: 1rem !important; margin-bottom: 1rem !important;">
                            <div class="form-group" style="flex: 1 1 calc(50% - 0.5rem) !important; min-width: 300px !important;">
                                <label for="cpruAffiliation">ความเกี่ยวข้องกับ CPRU *</label>
                                <select id="cpruAffiliation" name="cpruAffiliation" required style="width: 100% !important; box-sizing: border-box !important;">
                                    <option value="">เลือกความเกี่ยวข้อง</option>
                                    <option value="current-student">นักศึกษาปัจจุบัน</option>
                                    <option value="alumni">ศิษย์เก่า CPRU</option>
                                    <option value="staff">บุคลากร (อาจารย์, เจ้าหน้าที่)</option>
                                    <option value="general-public">บุคคลทั่วไป – ไม่เกี่ยวข้อง</option>
                                </select>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group" style="flex: 1 1 calc(50% - 0.5rem) !important; min-width: 300px !important;">
                                <label for="otherContact">ช่องทางติดต่ออื่น ๆ</label>
                                <input type="text" id="otherContact" name="otherContact" placeholder="Line ID, Facebook, หรือช่องทางอื่น ๆ" style="width: 100% !important; box-sizing: border-box !important;">
                                <div class="error-message"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Experience and Interests -->
                    <div class="form-section">
                        <h3><i class="fas fa-star"></i> ประสบการณ์และความสนใจ</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="experience">ประสบการณ์การเขียนโปรแกรม *</label>
                                <select id="experience" name="experience" required>
                                    <option value="">เลือกระดับประสบการณ์</option>
                                    <option value="never">ไม่เคยเขียน</option>
                                    <option value="beginner">เริ่มต้น (Beginner): 0-2 ปี</option>
                                    <option value="intermediate">มีประสบการณ์ (Intermediate): 3-7 ปี</option>
                                    <option value="advanced">เชี่ยวชาญ (Advanced): 8+ ปี</option>
                                </select>
                                <div class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="programmingLanguages">ภาษาโปรแกรมที่ใช้</label>
                                <input type="text" id="programmingLanguages" name="programmingLanguages" placeholder="เช่น Python, Java, JavaScript">
                            </div>
                            <div class="form-group">
                                <label for="expectations">ความคาดหวังจากการอบรม</label>
                                <textarea id="expectations" name="expectations" rows="3" placeholder="บอกเราว่าคุณอยากได้อะไรจากการอบรมครั้งนี้"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="howDidYouHear">ช่องทางที่รู้จักการอบรมนี้ *</label>
                                <select id="howDidYouHear" name="howDidYouHear" required onchange="toggleOtherInput(this)">
                                    <option value="">เลือกช่องทาง</option>
                                    <option value="organizer">ผู้จัดงาน / ผู้ดูแลโครงการ</option>
                                    <option value="friend">เพื่อน / คนรู้จักแชร์โพสต์</option>
                                    <option value="website">เพจอื่น ๆ / เว็บไซต์ข่าวสาร</option>
                                    <option value="line">Line Group</option>
                                    <option value="google">ค้นหาจาก Google</option>
                                    <option value="other">ช่องทางอื่น ๆ</option>
                                </select>
                                <div class="error-message"></div>
                                <input type="text" id="otherChannel" name="otherChannel" placeholder="โปรดระบุช่องทางอื่น ๆ" style="display: none; margin-top: 0.5rem;">
                            </div>
                        </div>
                    </div>

                    <!-- Topic Selection -->
                    <div class="form-section">
                        <h3><i class="fas fa-heart"></i> หัวข้อที่สนใจ</h3>
                        <div class="topics-selection">
                            <div class="topic-option">
                                <input type="checkbox" id="topic-vibe" name="topics" value="vibe">
                                <label for="topic-vibe">
                                    <i class="fas fa-code"></i>
                                    <div class="topic-content">
                                        <h4>Vibe Coding</h4>
                                        <p>เขียนโค้ดที่มี Flow และ Rhythm</p>
                                    </div>
                                </label>
                            </div>
                            <div class="topic-option">
                                <input type="checkbox" id="topic-spec" name="topics" value="spec">
                                <label for="topic-spec">
                                    <i class="fas fa-file-alt"></i>
                                    <div class="topic-content">
                                        <h4>Spec-Driven Development</h4>
                                        <p>พัฒนาซอฟต์แวร์จาก Specification</p>
                                    </div>
                                </label>
                            </div>
                            <div class="topic-option">
                                <input type="checkbox" id="topic-context" name="topics" value="context">
                                <label for="topic-context">
                                    <i class="fas fa-brain"></i>
                                    <div class="topic-content">
                                        <h4>Context Engineering</h4>
                                        <p>จัดการ Context ให้มีประสิทธิภาพ</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Feedback -->
                    <div class="form-section">
                        <h3><i class="fas fa-comment"></i> ข้อเสนอแนะเพิ่มเติม</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="additionalFeedback">ข้อเสนอแนะเพิ่มเติม</label>
                                <textarea id="additionalFeedback" name="additionalFeedback" rows="4" cols="80" style="width: 100% !important; min-height: 120px !important; max-width: 100% !important; box-sizing: border-box !important; resize: vertical;" placeholder="ความคิดเห็นหรือข้อเสนอแนะอื่นๆ ที่เป็นประโยชน์"></textarea>
                                <div class="error-message"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="submit-section">
                        <button type="submit" class="submit-btn" id="submitBtn">
                            <i class="fas fa-paper-plane"></i>
                            ลงทะเบียนเข้าร่วมอบรม
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="organizer-info">
                <h3><i class="fas fa-heart"></i> ข้อมูลการติดต่อผู้จัดงาน</h3>
                <p><strong>จัดโดย:</strong> สาขาวิชาวิทยาการคอมพิวเตอร์ คณะศิลปศาสตร์และวิทยาศาสตร์ มหาวิทยาลัยราชภัฏชัยภูมิ</p>
                <p>หากมีข้อสงสัย สามารถติดต่อสอบถามรายละเอียดเพิ่มเติมได้ที่กล่องข้อความ (Inbox): <a href="https://m.me/narasakp" target="_blank" rel="noopener noreferrer">facebook.com/narasakp</a></p>
            </div>
        </div>
    </div>

    <script>
        // ฟังก์ชันดึงข้อมูลจำนวนผู้ลงทะเบียนจาก Google Sheet จริงๆ (ไม่ใช้ข้อมูลจำลอง)
        async function updateRegistrationCounter() {
            const MAX_SEATS = 500;
            
            try {
                console.log('📝 กำลังดึงข้อมูลด้วย Form Submission...');
                
                // ใช้ Form Submission (วิธีเดียวที่ทำงานได้)
                const registeredCount = await fetchWithFormSubmission();
                const remainingSeats = MAX_SEATS - registeredCount;
                
                document.getElementById('registeredCount').textContent = registeredCount;
                document.getElementById('remainingSeats').textContent = remainingSeats;
                
                console.log(`✅ อัปเดตตัวนับสำเร็จ: ${registeredCount} คนลงทะเบียน, ${remainingSeats} ที่เหลือ`);
                
                // บันทึกข้อมูลไว้ใน localStorage
                localStorage.setItem('lastKnownCount', registeredCount.toString());
                
            } catch (error) {
                console.error('❌ เกิดข้อผิดพลาดในการอัปเดตตัวนับ:', error);
                document.getElementById('registeredCount').textContent = 'Error';
                document.getElementById('remainingSeats').textContent = 'Error';
            }
        }
        
        // ฟังก์ชันสำหรับดึงข้อมูลจาก Google Sheet CSV (ทำงานได้แล้ว!)
        async function fetchWithFormSubmission() {
            try {
                const SHEET_ID = '1uI_TA9lR0RsLcakF_GGb7LsM5H8gR3XCnQuiWQ0NuUQ';
                const csvUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`;
                
                console.log('📊 กำลังดึงข้อมูลจาก Google Sheet CSV...');
                const response = await fetch(csvUrl, { 
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                if (response.ok) {
                    const csvText = await response.text();
                    const lines = csvText.split('\n').filter(line => line.trim() !== '');
                    const totalRegistrations = Math.max(0, lines.length - 1); // ลบ header row
                    
                    console.log(`✅ ดึงข้อมูลจาก Google Sheet สำเร็จ: ${totalRegistrations} คน`);
                    console.log(`📝 จำนวนบรรทัดทั้งหมด: ${lines.length}, ข้อมูลจริง: ${totalRegistrations}`);
                    
                    // บันทึกใน localStorage
                    localStorage.setItem('lastKnownCount', totalRegistrations.toString());
                    
                    return totalRegistrations;
                } else {
                    console.log('❌ Google Sheet CSV response ไม่สำเร็จ:', response.status);
                    return getEstimatedCount();
                }
            } catch (error) {
                console.log('❌ เกิดข้อผิดพลาดในการดึง Google Sheet CSV:', error.message);
                return getEstimatedCount();
            }
        }
        
        // ประมาณจำนวนลงทะเบียน
        function getEstimatedCount() {
            const savedCount = localStorage.getItem('lastKnownCount');
            if (savedCount && !isNaN(parseInt(savedCount))) {
                const count = parseInt(savedCount);
                console.log(`💾 ใช้ข้อมูลที่บันทึกไว้: ${count} คน`);
                return count;
            }
            
            const estimatedCount = 6; // จากข้อมูลล่าสุดที่ทราบ
            console.log(`📈 ใช้ข้อมูลประมาณ: ${estimatedCount} คน`);
            return estimatedCount;
        }
        
        // เรียกใช้ฟังก์ชันเมื่อหน้าเว็บโหลดเสร็จ (เฉพาะถ้าไม่มี script.js)
        document.addEventListener('DOMContentLoaded', function() {
            // ตรวจสอบว่ามี script.js ทำงานอยู่แล้วหรือไม่
            if (typeof loadRegistrationCounter === 'function') {
                console.log('⚠️ ตรวจพบ script.js ทำงานอยู่แล้ว - ข้าม inline script');
                return;
            }
            
            console.log('🚀 เริ่มโหลดตัวนับการลงทะเบียน (inline script)...');
            updateRegistrationCounter();
            
            // อัปเดตตัวนับทุก 60 วินาที (ลดความถี่)
            setInterval(updateRegistrationCounter, 60000);
        });
    </script>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3>ลงทะเบียนสำเร็จ!</h3>
            <p>ขอบคุณที่สมัครเข้าร่วมอบรม </p>เราจะส่งข้อมูลเพิ่มเติมไปยังอีเมลของคุณ</p>
            <div class="success-features">
                <div class="feature">
                    <i class="fas fa-envelope"></i>
                    <span>ได้รับอีเมลยืนยัน</span>
                </div>
                <div class="feature">
                    <i class="fas fa-calendar-plus"></i>
                    <span>เพิ่มลงปฏิทิน: เสาร์ ที่ 16 สิงหาคม 2568</span>
                </div>
            </div>
            <button class="modal-btn" onclick="closeModal()">เข้าใจแล้ว</button>
        </div>
    </div>

    <script src="script.js?v=20250812155500"></script>
</body>
</html>
