<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Marketing - ประชาสัมพันธ์หลักสูตรอบรม</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Quill Rich Text Editor -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <style>
        .email-marketing-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            font-family: 'Kanit', sans-serif;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }

        .header-section h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 600;
        }

        .header-section p {
            margin: 10px 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .email-list-section, .email-template-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .email-input-area {
            margin-bottom: 20px;
        }

        .email-textarea {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-family: 'Kanit', sans-serif;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .email-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .email-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .template-editor {
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-family: 'Kanit', sans-serif;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .template-textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-family: 'Kanit', sans-serif;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .template-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Rich Text Editor Styles */
        .editor-container {
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            overflow: hidden;
            transition: border-color 0.3s;
        }

        .editor-container:focus-within {
            border-color: #667eea;
        }

        .ql-editor {
            min-height: 300px;
            font-family: 'Kanit', sans-serif;
            font-size: 14px;
            line-height: 1.6;
        }

        .ql-toolbar {
            border-bottom: 1px solid #e1e5e9;
            background: #f8f9fa;
        }

        .template-mode-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .mode-button {
            padding: 8px 16px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Kanit', sans-serif;
            font-size: 14px;
            transition: all 0.3s;
        }

        .mode-button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .mode-button:hover {
            border-color: #667eea;
        }

        .email-preview {
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 20px;
            background: white;
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .template-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .template-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .template-option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .template-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .template-option h4 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 1rem;
        }

        .template-option p {
            margin: 0;
            color: #666;
            font-size: 0.85rem;
        }

        .send-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .send-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .send-option {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .send-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .send-option h3 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1.2rem;
        }

        .send-option p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .batch-settings {
            display: none;
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .batch-settings.show {
            display: block;
        }

        .batch-input {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .batch-input label {
            font-weight: 500;
            color: #333;
        }

        .batch-input input {
            width: 80px;
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
        }

        .send-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
            font-family: 'Kanit', sans-serif;
        }

        .send-button:hover {
            transform: translateY(-2px);
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .progress-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .progress-section.show {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e1e5e9;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            font-weight: 500;
            color: #333;
        }

        .log-section {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 12px;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }

        .log-success {
            background: #d4edda;
            color: #155724;
        }

        .log-error {
            background: #f8d7da;
            color: #721c24;
        }

        .log-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .email-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .send-options {
                grid-template-columns: 1fr;
            }

            .header-section h1 {
                font-size: 2rem;
            }
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .warning-box h4 {
            margin: 0 0 10px 0;
            color: #856404;
        }

        .warning-box ul {
            margin: 0;
            padding-left: 20px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="email-marketing-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1><i class="fas fa-envelope"></i> Email Marketing</h1>
            <p>ประชาสัมพันธ์หลักสูตรอบรม "การสอนเขียนโค้ดในยุค AI"</p>
        </div>

        <!-- Warning Box -->
        <div class="warning-box">
            <h4><i class="fas fa-exclamation-triangle"></i> ข้อจำกัดของ Gmail</h4>
            <ul>
                <li>Gmail มีขีดจำกัด 500 อีเมล/วัน สำหรับบัญชีธรรมดา</li>
                <li>Gmail Workspace มีขีดจำกัด 2,000 อีเมล/วัน</li>
                <li>แนะนำส่งเป็นแบทช์ ครั้งละ 50-100 อีเมล</li>
                <li>ควรมีช่วงพักระหว่างการส่ง 1-2 นาที</li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Email List Section -->
            <div class="email-list-section">
                <h2 class="section-title">
                    <i class="fas fa-list"></i>
                    รายชื่ออีเมล
                </h2>

                <div class="email-input-area">
                    <textarea 
                        id="emailList" 
                        class="email-textarea" 
                        placeholder="ใส่รายชื่ออีเมลที่นี่ (แยกด้วย Enter หรือ Comma)&#10;&#10;ตัวอย่าง:&#10;user1@example.com&#10;user2@example.com&#10;user3@example.com"
                    ></textarea>
                </div>

                <div class="email-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalEmails">0</div>
                        <div class="stat-label">อีเมลทั้งหมด</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="validEmails">0</div>
                        <div class="stat-label">อีเมลที่ถูกต้อง</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="invalidEmails">0</div>
                        <div class="stat-label">อีเมลที่ผิด</div>
                    </div>
                </div>

                <button type="button" class="send-button" onclick="loadSampleEmails()">
                    <i class="fas fa-download"></i> โหลดตัวอย่างอีเมล
                </button>
            </div>

            <!-- Email Template Section -->
            <div class="email-template-section">
                <h2 class="section-title">
                    <i class="fas fa-edit"></i>
                    เทมเพลตอีเมล
                </h2>

                <div class="template-editor">
                    <div class="form-group">
                        <label for="emailSubject">หัวข้ออีเมล:</label>
                        <input 
                            type="text" 
                            id="emailSubject" 
                            class="form-input"
                            value="🚀 เชิญร่วมอบรม (ออนไลน์): AI Coding ฟรี!"
                        >
                    </div>

                    <!-- Template Selection -->
                    <div class="form-group">
                        <label>เลือกเทมเพลต:</label>
                        <div class="template-options">
                            <div class="template-option selected" onclick="selectTemplate('professional')">
                                <h4><i class="fas fa-briefcase"></i> มืออาชีพ</h4>
                                <p>ดีไซน์สะอาด เป็นทางการ</p>
                            </div>
                            <div class="template-option" onclick="selectTemplate('modern')">
                                <h4><i class="fas fa-rocket"></i> โมเดิร์น</h4>
                                <p>สีสันสดใส ทันสมัย</p>
                            </div>
                            <div class="template-option" onclick="selectTemplate('minimal')">
                                <h4><i class="fas fa-leaf"></i> มินิมอล</h4>
                                <p>เรียบง่าย อ่านง่าย</p>
                            </div>
                        </div>
                    </div>

                    <!-- Editor Mode Toggle -->
                    <div class="form-group">
                        <label>โหมดแก้ไข:</label>
                        <div class="template-mode-toggle">
                            <button type="button" class="mode-button active" onclick="switchEditorMode('rich')">
                                <i class="fas fa-paint-brush"></i> Rich Text
                            </button>
                            <button type="button" class="mode-button" onclick="switchEditorMode('html')">
                                <i class="fas fa-code"></i> HTML
                            </button>
                            <button type="button" class="mode-button" onclick="switchEditorMode('preview')">
                                <i class="fas fa-eye"></i> Preview
                            </button>
                        </div>
                    </div>

                    <!-- Rich Text Editor -->
                    <div class="form-group" id="richEditorGroup">
                        <label>เนื้อหาอีเมล:</label>
                        <div class="editor-container">
                            <div id="emailEditor"></div>
                        </div>
                    </div>

                    <!-- HTML Editor -->
                    <div class="form-group" id="htmlEditorGroup" style="display: none;">
                        <label>HTML Code:</label>
                        <textarea 
                            id="emailBodyHTML" 
                            class="template-textarea"
                            style="height: 300px; font-family: monospace;"
                            placeholder="HTML code จะแสดงที่นี่..."
                        ></textarea>
                    </div>

                    <!-- Preview -->
                    <div class="form-group" id="previewGroup" style="display: none;">
                        <label>ตัวอย่างอีเมล:</label>
                        <div class="email-preview" id="emailPreview"></div>
                    </div>

                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button type="button" class="send-button" onclick="loadDefaultTemplate()">
                            <i class="fas fa-magic"></i> โหลดเทมเพลตเริ่มต้น
                        </button>
                        <button type="button" class="send-button" onclick="previewEmail()">
                            <i class="fas fa-eye"></i> ดูตัวอย่าง
                        </button>
                        <button type="button" class="send-button" onclick="testSendEmail()">
                            <i class="fas fa-paper-plane"></i> ทดสอบส่ง
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Send Section -->
        <div class="send-section">
            <h2 class="section-title">
                <i class="fas fa-paper-plane"></i>
                ตัวเลือกการส่ง
            </h2>

            <div class="send-options">
                <div class="send-option selected" onclick="selectSendOption('all')">
                    <h3><i class="fas fa-rocket"></i> ส่งทั้งหมดทีเดียว</h3>
                    <p>ส่งอีเมลไปยังรายชื่อทั้งหมดในครั้งเดียว</p>
                </div>
                <div class="send-option" onclick="selectSendOption('batch')">
                    <h3><i class="fas fa-layer-group"></i> ส่งเป็นแบทช์</h3>
                    <p>แบ่งส่งเป็นกลุ่มย่อย มีช่วงพักระหว่างการส่ง</p>
                </div>
            </div>

            <div class="batch-settings" id="batchSettings">
                <div class="batch-input">
                    <label>ส่งครั้งละ:</label>
                    <input type="number" id="batchSize" value="100" min="1" max="200">
                    <label>อีเมล</label>
                    <label>พักระหว่างการส่ง:</label>
                    <input type="number" id="batchDelay" value="30" min="10" max="300">
                    <label>วินาที</label>
                </div>
            </div>

            <button type="button" class="send-button" id="sendButton" onclick="startEmailCampaign()">
                <i class="fas fa-paper-plane"></i> เริ่มส่งอีเมล
            </button>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" id="progressSection">
            <h2 class="section-title">
                <i class="fas fa-chart-line"></i>
                ความคืบหน้า
            </h2>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">0 / 0 อีเมล (0%)</div>

            <div class="log-section" id="logSection">
                <div class="log-entry log-info">พร้อมเริ่มส่งอีเมล...</div>
            </div>
        </div>
    </div>

    <script src="email-marketing.js"></script>
    <script src="email-templates.js"></script>
</body>
</html>
